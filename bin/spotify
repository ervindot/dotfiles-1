#!/bin/bash

spotify=/usr/bin/spotify
spotblock=/usr/bin/spotblock
yabar=/usr/bin/yabar

function checkSpotify {
    if [[ -x $spotify && -x $spotblock ]];
    then
        case "$(pidof yabar | wc -w)" in
            0) 
                $spotblock &
                spot_id=$!
                $spotify
                trap "kill -9 $spot_id" SIGINT SIGTERM EXIT
                ;; # no instance running .. continue
            1) 
                kill $(pidof yabar)
                $yabar -c /tmp/yabar-sp.conf &
                yb_id=$!
                $spotblock &
                spot_id=$!
                $spotify
                # note: running custom yabar script here
                trap "kill -9 $spot_id $yb_id; yabar" \
                    SIGINT SIGTERM EXIT
                ;;
        esac
    fi
}

checkSpotify

